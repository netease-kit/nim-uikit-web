<!-- 团队头像编辑页面 -->
<view class="team-avatar-edit-container">
  <!-- 导航栏 -->
  <view class="nav-bar" style="padding-top: {{statusBarHeight}}px;">
    <view class="nav-content">
      <view class="nav-left" bindtap="handleBack">
        <icon type="icon-zuojiantou" size="20" color="#333333" />
        <text class="nav-back-text">返回</text>
      </view>
      <view class="nav-title">修改头像</view>
      <view class="nav-right"></view>
    </view>
  </view>

  <!-- 内容区域 -->
  <view class="content-container">
    <!-- 当前头像显示区域 -->
    <view class="avatar-container">
      <view class="current-avatar" wx:if="{{hasPermission}}" bindtap="handleCustomUpload">
        <image wx:if="{{currentAvatar}}" src="{{currentAvatar}}" class="avatar-image" mode="aspectFill" />
        <view wx:else class="avatar-placeholder" style="background-color: {{avatarColor}}">
          <text class="avatar-text">{{displayName}}</text>
        </view>
        <view class="upload-icon">
          <image src="https://yx-web-nosdn.netease.im/common/97b3ca79a589d5753cbc0e8e8ec09501/choose-picture.png" class="upload-icon-img" />
        </view>
      </view>
      <view class="current-avatar" wx:else>
        <image wx:if="{{currentAvatar}}" src="{{currentAvatar}}" class="avatar-image" mode="aspectFill" />
        <view wx:else class="avatar-placeholder" style="background-color: {{avatarColor}}">
          <text class="avatar-text">{{displayName}}</text>
        </view>
      </view>
    </view>

    <!-- 默认头像选择区域 -->
    <view class="default-avatars-container" wx:if="{{hasPermission}}">
      <view class="section-title">选择默认头像</view>
      <view class="avatars-grid">
        <view 
          class="avatar-item {{selectedIndex === index ? 'selected' : ''}}" 
          wx:for="{{defaultAvatars}}" 
          wx:key="index"
          bindtap="handleSelectAvatar"
          data-index="{{index}}"
        >
          <image src="{{item}}" class="default-avatar-image" mode="aspectFill" />
        </view>
      </view>
    </view>

    <!-- 保存按钮 -->
    <view class="save-button-container" wx:if="{{hasPermission}}">
      <button class="save-button" bindtap="handleSave" disabled="{{saving}}">
        {{saving ? '保存中...' : '保存'}}
      </button>
    </view>
  </view>

  <!-- 加载提示 -->
  <view class="loading-overlay" wx:if="{{loading}}">
    <view class="loading-content">
      <view class="loading-spinner"></view>
      <text class="loading-text">{{loadingText}}</text>
    </view>
  </view>
</view>