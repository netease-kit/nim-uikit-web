<view class="message-g2 {{theme === 'dark' ? 'message-g2--dark' : ''}}" wx:if="{{g2Msg}}">
  <!-- 群聊消息头部 -->
  <view class="message-g2__header">
    <view class="message-g2__title">{{g2Msg.title || '群聊消息'}}</view>
    <view class="message-g2__subtitle" wx:if="{{g2Msg.subtitle}}">{{g2Msg.subtitle}}</view>
  </view>
  
  <!-- 群聊消息内容 -->
  <view class="message-g2__content">
    <!-- 群聊信息 -->
    <view class="message-g2__group-info" wx:if="{{g2Msg.groupInfo}}">
      <message-avatar 
        avatar="{{g2Msg.groupInfo.avatar}}"
        name="{{g2Msg.groupInfo.name}}"
        size="40"
        theme="{{theme}}"
        class="message-g2__group-avatar"
      />
      <view class="message-g2__group-details">
        <view class="message-g2__group-name">{{g2Msg.groupInfo.name || '未知群聊'}}</view>
        <view class="message-g2__group-desc" wx:if="{{g2Msg.groupInfo.description}}">
          {{g2Msg.groupInfo.description}}
        </view>
        <view class="message-g2__group-member-count" wx:if="{{g2Msg.groupInfo.memberCount}}">
          {{g2Msg.groupInfo.memberCount}}人
        </view>
      </view>
    </view>
    
    <!-- 消息列表 -->
    <view class="message-g2__messages" wx:if="{{g2Msg.messages && g2Msg.messages.length > 0}}">
      <view class="message-g2__messages-title">聊天记录</view>
      <view class="message-g2__message-list">
        <view 
          class="message-g2__message-item"
          wx:for="{{displayMessages}}"
          wx:key="{{item.id || index}}"
          data-message="{{item}}"
          bindtap="handleMessageClick"
        >
          <view class="message-g2__message-sender">{{item.senderName || '未知用户'}}</view>
          <view class="message-g2__message-content">
            <!-- 文本消息 -->
            <text wx:if="{{item.type === 'text'}}" class="message-g2__message-text">
              {{item.content || ''}}
            </text>
            
            <!-- 图片消息 -->
            <view wx:elif="{{item.type === 'image'}}" class="message-g2__message-media">
              <icon name="image" size="14" color="#999" />
              <text class="message-g2__message-media-text">[图片]</text>
            </view>
            
            <!-- 音频消息 -->
            <view wx:elif="{{item.type === 'audio'}}" class="message-g2__message-media">
              <icon name="audio" size="14" color="#999" />
              <text class="message-g2__message-media-text">[语音]</text>
            </view>
            
            <!-- 视频消息 -->
            <view wx:elif="{{item.type === 'video'}}" class="message-g2__message-media">
              <icon name="video" size="14" color="#999" />
              <text class="message-g2__message-media-text">[视频]</text>
            </view>
            
            <!-- 文件消息 -->
            <view wx:elif="{{item.type === 'file'}}" class="message-g2__message-media">
              <icon name="file" size="14" color="#999" />
              <text class="message-g2__message-media-text">[文件] {{item.fileName || ''}}</text>
            </view>
            
            <!-- 位置消息 -->
            <view wx:elif="{{item.type === 'location'}}" class="message-g2__message-media">
              <icon name="location" size="14" color="#999" />
              <text class="message-g2__message-media-text">[位置]</text>
            </view>
            
            <!-- 自定义消息 -->
            <view wx:elif="{{item.type === 'custom'}}" class="message-g2__message-media">
              <icon name="custom" size="14" color="#999" />
              <text class="message-g2__message-media-text">[自定义消息]</text>
            </view>
            
            <!-- 其他类型消息 -->
            <view wx:else class="message-g2__message-media">
              <icon name="message" size="14" color="#999" />
              <text class="message-g2__message-media-text">[{{getMessageTypeText(item.type)}}]</text>
            </view>
          </view>
          <view class="message-g2__message-time" wx:if="{{item.time}}">
            {{formatMessageTime(item.time)}}
          </view>
        </view>
      </view>
      
      <!-- 更多消息提示 -->
      <view 
        class="message-g2__more-messages"
        wx:if="{{hasMoreMessages}}"
        bindtap="handleShowMore"
      >
        <text class="message-g2__more-text">查看更多消息 ({{totalMessageCount - displayMessages.length}}条)</text>
        <icon name="arrow-right" size="12" color="#999" />
      </view>
    </view>
    
    <!-- 操作按钮 -->
    <view class="message-g2__actions" wx:if="{{showActions}}">
      <view 
        class="message-g2__action-btn message-g2__action-btn--primary"
        bindtap="handleJoinGroup"
        wx:if="{{g2Msg.groupInfo && !g2Msg.groupInfo.joined}}"
      >
        加入群聊
      </view>
      <view 
        class="message-g2__action-btn message-g2__action-btn--secondary"
        bindtap="handleViewGroup"
        wx:if="{{g2Msg.groupInfo}}"
      >
        查看群聊
      </view>
    </view>
  </view>
  
  <!-- 时间戳 -->
  <view class="message-g2__timestamp" wx:if="{{showTime && formatTime}}">
    {{formatTime}}
  </view>
</view>