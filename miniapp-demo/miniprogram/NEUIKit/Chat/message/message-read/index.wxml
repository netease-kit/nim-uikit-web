<view class="message-read {{theme === 'dark' ? 'message-read--dark' : ''}}" wx:if="{{readInfo}}">
  <!-- 简单模式：只显示已读状态 -->
  <view class="message-read__simple" wx:if="{{mode === 'simple'}}">
    <view class="message-read__status">
      <icon 
        name="{{getReadStatusIcon()}}"
        size="12" 
        color="{{getReadStatusColor()}}"
        class="message-read__status-icon"
      />
      <text class="message-read__status-text">{{getReadStatusText()}}</text>
    </view>
    <view class="message-read__time" wx:if="{{showTime && formatTime}}">
      {{formatTime}}
    </view>
  </view>
  
  <!-- 详细模式：显示已读用户列表 -->
  <view class="message-read__detail" wx:elif="{{mode === 'detail'}}">
    <!-- 头部信息 -->
    <view class="message-read__header">
      <view class="message-read__title">消息已读状态</view>
      <view class="message-read__summary">
        <text class="message-read__summary-text">
          已读 {{readInfo.readCount || 0}} / {{readInfo.totalCount || 0}}
        </text>
      </view>
    </view>
    
    <!-- 已读用户列表 -->
    <view class="message-read__section" wx:if="{{readUsers && readUsers.length > 0}}">
      <view class="message-read__section-title">
        <icon name="check-circle" size="14" color="#34c759" />
        <text class="message-read__section-text">已读 ({{readUsers.length}})</text>
      </view>
      <view class="message-read__user-list">
        <view 
          class="message-read__user-item"
          wx:for="{{readUsers}}"
          wx:key="{{item.userId || index}}"
          data-user="{{item}}"
          bindtap="handleUserClick"
        >
          <message-avatar 
            avatar="{{item.avatar}}"
            name="{{item.name || item.userId}}"
            size="32"
            theme="{{theme}}"
            class="message-read__user-avatar"
          />
          <view class="message-read__user-info">
            <view class="message-read__user-name">{{item.name || item.userId || '未知用户'}}</view>
            <view class="message-read__user-time" wx:if="{{item.readTime}}">
              {{formatUserReadTime(item.readTime)}}
            </view>
          </view>
        </view>
      </view>
    </view>
    
    <!-- 未读用户列表 -->
    <view class="message-read__section" wx:if="{{unreadUsers && unreadUsers.length > 0}}">
      <view class="message-read__section-title">
        <icon name="clock" size="14" color="#999" />
        <text class="message-read__section-text">未读 ({{unreadUsers.length}})</text>
      </view>
      <view class="message-read__user-list">
        <view 
          class="message-read__user-item"
          wx:for="{{unreadUsers}}"
          wx:key="{{item.userId || index}}"
          data-user="{{item}}"
          bindtap="handleUserClick"
        >
          <message-avatar 
            avatar="{{item.avatar}}"
            name="{{item.name || item.userId}}"
            size="32"
            theme="{{theme}}"
            class="message-read__user-avatar"
          />
          <view class="message-read__user-info">
            <view class="message-read__user-name">{{item.name || item.userId || '未知用户'}}</view>
            <view class="message-read__user-status">未读</view>
          </view>
        </view>
      </view>
    </view>
    
    <!-- 空状态 -->
    <view class="message-read__empty" wx:if="{{isEmpty}}">
      <icon name="info" size="24" color="#ccc" />
      <text class="message-read__empty-text">暂无已读信息</text>
    </view>
  </view>
  
  <!-- 弹窗模式：显示已读详情弹窗 -->
  <view class="message-read__modal" wx:elif="{{mode === 'modal' && visible}}">
    <!-- 遮罩 -->
    <view class="message-read__mask" bindtap="handleMaskClick"></view>
    
    <!-- 弹窗内容 -->
    <view class="message-read__modal-content" catchtap="stopPropagation">
      <!-- 弹窗头部 -->
      <view class="message-read__modal-header">
        <view class="message-read__modal-title">消息已读状态</view>
        <view class="message-read__modal-close" bindtap="handleClose">
          <icon name="close" size="16" color="#999" />
        </view>
      </view>
      
      <!-- 统计信息 -->
      <view class="message-read__modal-stats">
        <view class="message-read__stat-item">
          <text class="message-read__stat-number">{{readInfo.readCount || 0}}</text>
          <text class="message-read__stat-label">已读</text>
        </view>
        <view class="message-read__stat-divider"></view>
        <view class="message-read__stat-item">
          <text class="message-read__stat-number">{{readInfo.unreadCount || 0}}</text>
          <text class="message-read__stat-label">未读</text>
        </view>
      </view>
      
      <!-- 标签页 -->
      <view class="message-read__tabs">
        <view 
          class="message-read__tab {{activeTab === 'read' ? 'message-read__tab--active' : ''}}"
          data-tab="read"
          bindtap="handleTabChange"
        >
          已读 ({{readUsers.length}})
        </view>
        <view 
          class="message-read__tab {{activeTab === 'unread' ? 'message-read__tab--active' : ''}}"
          data-tab="unread"
          bindtap="handleTabChange"
        >
          未读 ({{unreadUsers.length}})
        </view>
      </view>
      
      <!-- 用户列表 -->
      <scroll-view class="message-read__modal-list" scroll-y="{{true}}">
        <!-- 已读用户 -->
        <view wx:if="{{activeTab === 'read'}}">
          <view 
            class="message-read__modal-user-item"
            wx:for="{{readUsers}}"
            wx:key="{{item.userId || index}}"
            data-user="{{item}}"
            bindtap="handleUserClick"
          >
            <message-avatar 
              avatar="{{item.avatar}}"
              name="{{item.name || item.userId}}"
              size="36"
              theme="{{theme}}"
              class="message-read__modal-user-avatar"
            />
            <view class="message-read__modal-user-info">
              <view class="message-read__modal-user-name">{{item.name || item.userId || '未知用户'}}</view>
              <view class="message-read__modal-user-time" wx:if="{{item.readTime}}">
                {{formatUserReadTime(item.readTime)}}
              </view>
            </view>
            <icon name="check-circle" size="16" color="#34c759" class="message-read__modal-user-status" />
          </view>
        </view>
        
        <!-- 未读用户 -->
        <view wx:elif="{{activeTab === 'unread'}}">
          <view 
            class="message-read__modal-user-item"
            wx:for="{{unreadUsers}}"
            wx:key="{{item.userId || index}}"
            data-user="{{item}}"
            bindtap="handleUserClick"
          >
            <message-avatar 
              avatar="{{item.avatar}}"
              name="{{item.name || item.userId}}"
              size="36"
              theme="{{theme}}"
              class="message-read__modal-user-avatar"
            />
            <view class="message-read__modal-user-info">
              <view class="message-read__modal-user-name">{{item.name || item.userId || '未知用户'}}</view>
              <view class="message-read__modal-user-desc">未读</view>
            </view>
            <icon name="clock" size="16" color="#999" class="message-read__modal-user-status" />
          </view>
        </view>
        
        <!-- 空状态 -->
        <view class="message-read__modal-empty" wx:if="{{getCurrentUsers().length === 0}}">
          <icon name="info" size="32" color="#ccc" />
          <text class="message-read__modal-empty-text">
            {{activeTab === 'read' ? '暂无已读用户' : '暂无未读用户'}}
          </text>
        </view>
      </scroll-view>
    </view>
  </view>
</view>